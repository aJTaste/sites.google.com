# AppHub 実装ログ

## 2025-10-29

### Phase 1: 権限システムの実装

#### 実装内容
1. **データベース構造の拡張**
   - `users` テーブルに `role`, `lastOnline`, `online` フィールドを追加
   - `servers`, `channels` テーブルの設計完了

2. **共通モジュールの作成**
   - `/common/permissions.js` - 権限チェック関数
   - `/common/presence.js` - オンライン状態管理（将来実装）

3. **既存コードの修正**
   - `register.js` - 新規登録時に `role: 'user'` を設定
   - `settings.js` - 権限に応じた表示制御
   - `chat/chat-main.js` - メッセージ削除の権限チェック強化

4. **管理者パネルの作成**
   - `admin.html` - ユーザー管理画面
   - `js/admin.js` - 権限変更機能

#### 権限の種類
- `owner` - 管理者（全権限）
- `moderator` - 準管理者（ユーザー管理、サーバー管理）
- `verified` - 承認済み（サーバー作成可能）
- `user` - 一般ユーザー（基本機能のみ）

#### 次のチャット用メモ
- Phase 2: サーバー作成機能を実装
- サーバー一覧表示UI
- サーバー作成フォーム（verified以上のみ）
- チャンネル作成機能

#### 注意事項
- 既存のRoom1-10は残す（後でパブリックサーバーに統合可能）
- 権限変更は管理者パネルからのみ可能
- 初回登録ユーザーは全員 `user` 権限でスタート

---

## 今後の実装予定

### Phase 2: サーバー作成機能（次回）
- [ ] サーバー一覧UI
- [ ] サーバー作成フォーム
- [ ] サーバー設定画面
- [ ] チャンネル作成機能

### Phase 3: 絵文字・リアクション
- [ ] 絵文字ピッカー（手のジェスチャー中心）
- [ ] メッセージへのリアクション機能
- [ ] カスタム絵文字（将来）

### Phase 4: オンライン表示
- [ ] リアルタイムプレゼンス管理
- [ ] オンラインユーザーリスト
- [ ] アプリ全体とページ別の表示

### Phase 5: その他機能
- [ ] 通知システム
- [ ] ファイル共有機能
- [ ] HTMLプレビュー機能